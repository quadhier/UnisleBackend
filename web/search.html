
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" charset="UTF-8">
		<link href="css/search/styles.css"  rel="stylesheet" type="text/css"/>
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="js/jquery-ui-1.8.10.custom.min.js"></script>
		<script type="text/javascript">
			var searchContent = null;
			var searchType = null;

            $(document).unbind('ready').ready(function () {

                $.ajax({
                    type: "GET",
                    url: "self",
                    dataType: "json",
                    data:{},
                    async:false,
                    timeout:5000,
                    cache:false,
                    success: function (res) {
                        if(res.result == 'LOGINERROR'){
                            window.reload('login.html');
                        }
                        if(res.result != 'SUCCESS'){
                            alert('获取用户个人信息失败，请刷新或重新登陆。')
                        }
                    }

                });
                if(innerURL.valueOf('?')>0){
                    searchContent = innerURL.split('?')[1].split('=')[1];
                    searchType = 'type_self';
                    $("#type_self").css("background-color","rgba(255,255,255,0.57)");
                    loadAjax(searchContent,searchType);
				}else{
                    searchType = 'type_self';
                    $("#type_self").css("background-color","rgba(255,255,255,0.57)");
				}



                function loadAjax(content,type) {
                    searchContent = content;
                    searchType = type;
                    var selfRst=$.ajax({url:"searchResult.html",async:false});
                    $("#searchRst").css("top","4px");
                    $("#searchRst").html(selfRst.responseText);
                }


                $("#type_self").click(function () {
                    if($('#search_input').val() == null || $('#search_input').val().length == 0)
                    	return;
                    searchContent = $('#search_input').val();
                    searchType = 'type_self';
                    $(this).css("background-color","rgba(255,255,255,0.57)");
                    $("#type_org").css("background-color","rgba(204,204,204,0.8)");
                    $("#type_post").css("background-color","rgba(204,204,204,0.8)");

                    loadAjax(searchContent,searchType);
                });
                $("#type_org").click(function () {
                    if($('#search_input').val() == null || $('#search_input').val().length == 0)
                    	return;
                    searchContent = $('#search_input').val();
                    searchType = 'type_org';
                    $(this).css("background-color","rgba(255,255,255,0.57)");
                    $("#type_self").css("background-color","rgba(204,204,204,0.8)");
                    $("#type_post").css("background-color","rgba(204,204,204,0.8)");

                    loadAjax(searchContent,searchType);
                });
                $("#type_post").click(function () {
                    if($('#search_input').val() == null || $('#search_input').val().length == 0)
                    	return;
                    searchContent = $('#search_input').val();
                    searchType = 'type_post';
                    $(this).css("background-color","rgba(255,255,255,0.57)");
                    $("#type_org").css("background-color","rgba(204,204,204,0.8)");
                    $("#type_self").css("background-color","rgba(204,204,204,0.8)");

                    loadAjax(searchContent,searchType);
                });
                $('#searchBtn').click(function () {
                    if($('#search_input').val() == null || $('#search_input').val().length == 0)
                    	return;
                    searchContent = $('#search_input').val();
                    loadAjax(searchContent,searchType);
                });
                $("input").focus(function(){
                    $(this).parent().css("border-color","#bbbbff");
                    $(this).parent().css("box-shadow","0 0 4px #bbbbff");
                });
                $("input").blur(function(){
                    $(this).parent().css("border-color","#cccccc");
                    $(this).parent().css("box-shadow","none");
                });
                //子页面回调方法live绑定区，记得子页面生成前要先remove和die
				if(!firstSearch)
				    return;
                firstSearch = false;


            });
		</script>
		<title>Search</title>
	</head>
	<body>

		<div class="container">
			<div class="searchBarDiv">
				<div class="searchBar">
					<img id="searchImg" src="images/search/search.png"/>
					<input id="search_input" type="text" placeholder="Search">
				</div>
				<div id="searchBtn">
					<span>搜索</span>
				</div>
			</div>

			<div class="typeDiv">
				<div id="type_self">
					<span>个&nbsp;&nbsp;&nbsp;人</span>
				</div>
				<div id="type_org">
					<span>组&nbsp;&nbsp;&nbsp;织</span>
				</div>
				<div id="type_post">
					<span>贴&nbsp;&nbsp;&nbsp;子</span>
				</div>
			</div>

			<div class="searchRstDiv">
				<div id="searchRst">
					<!--AJAX动态加载搜索结果-->
				</div>
			</div>
		</div>
	</body>
</html>